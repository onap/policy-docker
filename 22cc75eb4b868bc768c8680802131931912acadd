{
  "comments": [
    {
      "key": {
        "uuid": "24658324_4e43384e",
        "filename": "policy-db-migrator/src/main/docker/config/policyadmin/sql/0900/downgrade/0160-pk_pdpstatistics.sql",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-08-20T15:09:24Z",
      "side": 1,
      "message": "oh, if that\u0027s all we\u0027re doing, then it probably doesn\u0027t matter",
      "revId": "22cc75eb4b868bc768c8680802131931912acadd",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9b7b11ba_289fcbc9",
        "filename": "policy-db-migrator/src/main/docker/config/policyadmin/sql/0900/upgrade/0210-sequence.sql",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-08-20T15:09:24Z",
      "side": 1,
      "message": "Just a question: is it OK to have an upgrade script without a corresponding downgrade?  (i.e., it won\u0027t break the db-migrator if it fails at this step, will it?)",
      "revId": "22cc75eb4b868bc768c8680802131931912acadd",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "30b631c2_412a18a7",
        "filename": "policy-db-migrator/src/main/docker/config/policyadmin/sql/0900/upgrade/0210-sequence.sql",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 7625
      },
      "writtenOn": "2021-08-20T15:14:34Z",
      "side": 1,
      "message": "if it fails at this step, then the next one won\u0027t successed anyway if we have data already set.\nyou can check with more details here https://wiki.onap.org/display/DW/OOM+Testing\nBut the issue is that when ID is created as NOT NULL, 0 is set to every existing row. in case of multiple name/version pairs, the new PK will fail with duplication. so we figured they could go on the same sql because PK set depends on it exclusively, if that makes sense :D",
      "parentUuid": "9b7b11ba_289fcbc9",
      "revId": "22cc75eb4b868bc768c8680802131931912acadd",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "44cce8b0_58b82db7",
        "filename": "policy-db-migrator/src/main/docker/config/policyadmin/sql/0900/upgrade/0210-sequence.sql",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-08-20T15:16:50Z",
      "side": 1,
      "message": "I was thinking, if it fails at this step and the user chose to do a downgrade to revert back to honolulu, would the migrator still work OK?  Or does it expect there to be a corresponding downgrade script?",
      "parentUuid": "30b631c2_412a18a7",
      "revId": "22cc75eb4b868bc768c8680802131931912acadd",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dfa6268d_d8449700",
        "filename": "policy-db-migrator/src/main/docker/config/policyadmin/sql/0900/upgrade/0210-sequence.sql",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 7625
      },
      "writtenOn": "2021-08-20T15:28:28Z",
      "side": 1,
      "message": "ok, I think I see what you mean now. Just confirmed that wouldn\u0027t cause an issue because downgrade would start from 0150 to 0100. The PK with timestamp would be created normally, as the previous was dropped and no new were created.",
      "parentUuid": "44cce8b0_58b82db7",
      "revId": "22cc75eb4b868bc768c8680802131931912acadd",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d3186caf_c6bf3203",
        "filename": "policy-db-migrator/src/main/docker/config/policyadmin/sql/0900/upgrade/0210-sequence.sql",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-08-20T15:35:38Z",
      "side": 1,
      "message": "If it fails at 160 and you run the downgrade this is the statement that is run:\n\nALTER TABLE pdpstatistics DROP COLUMN POLICYUNDEPLOYCOUNT, DROP COLUMN POLICYUNDEPLOYFAILCOUNT, DROP COLUMN POLICYUNDEPLOYSUCCESSCOUNT, DROP COLUMN ID;\n\nso everything is cleaned up.\n\nif you continue with the upgrade it will run both statements in 160 again which won\u0027t be a problem.",
      "parentUuid": "dfa6268d_d8449700",
      "revId": "22cc75eb4b868bc768c8680802131931912acadd",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c43edf1_af1cf772",
        "filename": "policy-db-migrator/src/main/docker/config/policyadmin/sql/0900/upgrade/0210-sequence.sql",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 7625
      },
      "writtenOn": "2021-08-23T08:08:07Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "d3186caf_c6bf3203",
      "revId": "22cc75eb4b868bc768c8680802131931912acadd",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    }
  ]
}