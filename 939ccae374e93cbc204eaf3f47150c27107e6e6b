{
  "comments": [
    {
      "key": {
        "uuid": "aca647e7_c0399c3c",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 396,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-07-20T14:33:17Z",
      "side": 1,
      "message": "what if we previously stopped in the middle of an upgrade (or downgrade)?  this appears to execute all scripts, when it should only execute some of them",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4edd897a_1fb01b79",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 396,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-07-20T14:48:27Z",
      "side": 1,
      "message": "Yes that is correct.\nIf you only want it to execute some of the scripts then you will have to manually delete the ones you don\u0027t want prior to running db-migrator",
      "parentUuid": "aca647e7_c0399c3c",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f8fec351_3f6ea070",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 396,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-07-20T15:14:11Z",
      "side": 1,
      "message": "hmm.  I thought the main reason for tracking the execution of the individual scripts in the DB was so that we knew exactly where to begin if we do an upgrade/downgrade: so it would be able to resume from there.\n\nIf there are 10 upgrade scripts and it ran seven of them, then:\n- if I request an upgrade, it should resume with the remaining three scripts, knowing that the previous seven had already been completed\n- OTOH, if I request a downgrade (i.e., rollback), then it should execute the downgrade scripts associated with the seven upgrade scripts that it had already completed, in reverse order",
      "parentUuid": "4edd897a_1fb01b79",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b184469_086c5f63",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 396,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-07-20T15:24:21Z",
      "side": 1,
      "message": "Yes it would be possible to do this.\nI would need to add a check to see what the last successful operation was for each script.\ne.g.\n0100-jpapolicyaudit.sql upgrade 0800    0900    2007211505070900u       1\nThe last entry for 0100-jpapolicyaudit.sql was a successful upgrade so there is no need to run it again if we are doing an upgrade.\nI will update the code to accommodate this.",
      "parentUuid": "f8fec351_3f6ea070",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6920d31e_914773f9",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 437,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-07-20T14:33:17Z",
      "side": 1,
      "message": "what if we previously stopped in the middle of an upgrade (or downgrade)?  this appears to execute all scripts, when it should only execute some of them",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bb2dd5b0_320dd244",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 437,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-07-20T14:48:27Z",
      "side": 1,
      "message": "Yes, same as above.\nIt will try to run all the script present in the directory.",
      "parentUuid": "6920d31e_914773f9",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "39758ddd_53285d48",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 437,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-07-20T15:24:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "bb2dd5b0_320dd244",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c43d8406_89a1a4fb",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 661,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-07-20T14:33:17Z",
      "side": 1,
      "message": "appears this could be changed to: $current !\u003d $input",
      "range": {
        "startLine": 661,
        "startChar": 11,
        "endLine": 661,
        "endChar": 117
      },
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a48c443a_17f0e696",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 661,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-07-20T14:48:27Z",
      "side": 1,
      "message": "Yes this is a good point.\nWe don\u0027t really need to take in this \"from\" parameter as you can only really upgrade or downgrade from the current release.",
      "parentUuid": "c43d8406_89a1a4fb",
      "range": {
        "startLine": 661,
        "startChar": 11,
        "endLine": 661,
        "endChar": 117
      },
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fa28183a_03621001",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 661,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-07-20T15:14:11Z",
      "side": 1,
      "message": "I\u0027m ok with removing it",
      "parentUuid": "a48c443a_17f0e696",
      "range": {
        "startLine": 661,
        "startChar": 11,
        "endLine": 661,
        "endChar": 117
      },
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ff78023c_4ae5ca3f",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 661,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-07-20T15:24:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "fa28183a_03621001",
      "range": {
        "startLine": 661,
        "startChar": 11,
        "endLine": 661,
        "endChar": 117
      },
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "edcf6cdd_eb5d7cd1",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 665,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-07-20T14:33:17Z",
      "side": 1,
      "message": "seems redundant, as it appears we can only get here if these two are already equal",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cfe83b02_1ba65cfd",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 665,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-07-20T14:48:27Z",
      "side": 1,
      "message": "Same as above.\nI left it in to be consistent with the original.",
      "parentUuid": "edcf6cdd_eb5d7cd1",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "236c033e_4d6b3637",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 665,
      "author": {
        "id": 811
      },
      "writtenOn": "2021-07-20T15:14:11Z",
      "side": 1,
      "message": "let\u0027s remove it",
      "parentUuid": "cfe83b02_1ba65cfd",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0d33e247_65449d50",
        "filename": "policy-db-migrator/src/main/docker/db-migrator",
        "patchSetId": 3
      },
      "lineNbr": 665,
      "author": {
        "id": 7668
      },
      "writtenOn": "2021-07-20T15:24:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "236c033e_4d6b3637",
      "revId": "939ccae374e93cbc204eaf3f47150c27107e6e6b",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": false
    }
  ]
}